<!DOCTYPE html>
<html class="writer-html5" lang="en" data-content_root="./">
<head>
  <meta charset="utf-8" /><meta name="viewport" content="width=device-width, initial-scale=1" />

  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <title>model.denoising package &mdash; GWAI  documentation</title>
      <link rel="stylesheet" type="text/css" href="_static/pygments.css?v=80d5e7a1" />
      <link rel="stylesheet" type="text/css" href="_static/css/theme.css?v=19f00094" />

  
  <!--[if lt IE 9]>
    <script src="_static/js/html5shiv.min.js"></script>
  <![endif]-->
  
        <script src="_static/jquery.js?v=5d32c60e"></script>
        <script src="_static/_sphinx_javascript_frameworks_compat.js?v=2cd50e6c"></script>
        <script src="_static/documentation_options.js?v=5929fcd5"></script>
        <script src="_static/doctools.js?v=9a2dae69"></script>
        <script src="_static/sphinx_highlight.js?v=dc90522c"></script>
    <script src="_static/js/theme.js"></script>
    <link rel="index" title="Index" href="genindex.html" />
    <link rel="search" title="Search" href="search.html" />
    <link rel="next" title="model.denoising.data package" href="model.denoising.data.html" />
    <link rel="prev" title="model.classify package" href="model.classify.html" /> 
</head>

<body class="wy-body-for-nav"> 
  <div class="wy-grid-for-nav">
    <nav data-toggle="wy-nav-shift" class="wy-nav-side">
      <div class="wy-side-scroll">
        <div class="wy-side-nav-search" >

          
          
          <a href="index.html" class="icon icon-home">
            GWAI
          </a>
<div role="search">
  <form id="rtd-search-form" class="wy-form" action="search.html" method="get">
    <input type="text" name="q" placeholder="Search docs" aria-label="Search docs" />
    <input type="hidden" name="check_keywords" value="yes" />
    <input type="hidden" name="area" value="default" />
  </form>
</div>
        </div><div class="wy-menu wy-menu-vertical" data-spy="affix" role="navigation" aria-label="Navigation menu">
              <ul class="current">
<li class="toctree-l1"><a class="reference internal" href="about_gwai.html">About GWAI</a></li>
<li class="toctree-l1"><a class="reference internal" href="getting_started.html">Getting started</a></li>
<li class="toctree-l1"><a class="reference internal" href="tutorials.html">Tutorials</a></li>
<li class="toctree-l1 current"><a class="reference internal" href="modules.html">src</a><ul class="current">
<li class="toctree-l2"><a class="reference internal" href="data.html">data package</a></li>
<li class="toctree-l2"><a class="reference internal" href="eval.html">eval package</a></li>
<li class="toctree-l2 current"><a class="reference internal" href="model.html">model package</a><ul class="current">
<li class="toctree-l3 current"><a class="reference internal" href="model.html#subpackages">Subpackages</a><ul class="current">
<li class="toctree-l4"><a class="reference internal" href="model.classify.html">model.classify package</a></li>
<li class="toctree-l4 current"><a class="current reference internal" href="#">model.denoising package</a></li>
<li class="toctree-l4"><a class="reference internal" href="model.detection.html">model.detection package</a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="model.html#module-model">Module contents</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="utils.html">utils package</a></li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="citations.html">Citations</a></li>
</ul>

        </div>
      </div>
    </nav>

    <section data-toggle="wy-nav-shift" class="wy-nav-content-wrap"><nav class="wy-nav-top" aria-label="Mobile navigation menu" >
          <i data-toggle="wy-nav-top" class="fa fa-bars"></i>
          <a href="index.html">GWAI</a>
      </nav>

      <div class="wy-nav-content">
        <div class="rst-content">
          <div role="navigation" aria-label="Page navigation">
  <ul class="wy-breadcrumbs">
      <li><a href="index.html" class="icon icon-home" aria-label="Home"></a></li>
          <li class="breadcrumb-item"><a href="modules.html">src</a></li>
          <li class="breadcrumb-item"><a href="model.html">model package</a></li>
      <li class="breadcrumb-item active">model.denoising package</li>
      <li class="wy-breadcrumbs-aside">
            <a href="_sources/model.denoising.rst.txt" rel="nofollow"> View page source</a>
      </li>
  </ul>
  <hr/>
</div>
          <div role="main" class="document" itemscope="itemscope" itemtype="http://schema.org/Article">
           <div itemprop="articleBody">
             
  <section id="model-denoising-package">
<h1>model.denoising package<a class="headerlink" href="#model-denoising-package" title="Link to this heading"></a></h1>
<section id="subpackages">
<h2>Subpackages<a class="headerlink" href="#subpackages" title="Link to this heading"></a></h2>
<div class="toctree-wrapper compound">
<ul>
<li class="toctree-l1"><a class="reference internal" href="model.denoising.data.html">model.denoising.data package</a><ul>
<li class="toctree-l2"><a class="reference internal" href="model.denoising.data.html#submodules">Submodules</a></li>
<li class="toctree-l2"><a class="reference internal" href="model.denoising.data.html#module-model.denoising.data.data_samplers">model.denoising.data.data_samplers module</a><ul>
<li class="toctree-l3"><a class="reference internal" href="model.denoising.data.html#model.denoising.data.data_samplers.MegatronPretrainingRandomSampler"><code class="docutils literal notranslate"><span class="pre">MegatronPretrainingRandomSampler</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="model.denoising.data.html#model.denoising.data.data_samplers.MegatronPretrainingSampler"><code class="docutils literal notranslate"><span class="pre">MegatronPretrainingSampler</span></code></a><ul>
<li class="toctree-l4"><a class="reference internal" href="model.denoising.data.html#model.denoising.data.data_samplers.MegatronPretrainingSampler.get_start_end_idx"><code class="docutils literal notranslate"><span class="pre">MegatronPretrainingSampler.get_start_end_idx()</span></code></a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="model.denoising.data.html#model.denoising.data.data_samplers.build_pretraining_data_loader"><code class="docutils literal notranslate"><span class="pre">build_pretraining_data_loader()</span></code></a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="model.denoising.data.html#module-model.denoising.data.dataset_utils">model.denoising.data.dataset_utils module</a><ul>
<li class="toctree-l3"><a class="reference internal" href="model.denoising.data.html#model.denoising.data.dataset_utils.build_train_valid_test_datasets"><code class="docutils literal notranslate"><span class="pre">build_train_valid_test_datasets()</span></code></a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="model.denoising.data.html#module-model.denoising.data.gw_dataset">model.denoising.data.gw_dataset module</a><ul>
<li class="toctree-l3"><a class="reference internal" href="model.denoising.data.html#model.denoising.data.gw_dataset.GwDataset"><code class="docutils literal notranslate"><span class="pre">GwDataset</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="model.denoising.data.html#model.denoising.data.gw_dataset.get_samples"><code class="docutils literal notranslate"><span class="pre">get_samples()</span></code></a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="model.denoising.data.html#module-model.denoising.data">Module contents</a></li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="model.denoising.fused_kernels.html">model.denoising.fused_kernels package</a><ul>
<li class="toctree-l2"><a class="reference internal" href="model.denoising.fused_kernels.html#module-model.denoising.fused_kernels">Module contents</a><ul>
<li class="toctree-l3"><a class="reference internal" href="model.denoising.fused_kernels.html#model.denoising.fused_kernels.load"><code class="docutils literal notranslate"><span class="pre">load()</span></code></a></li>
</ul>
</li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="model.denoising.model.html">model.denoising.model package</a><ul>
<li class="toctree-l2"><a class="reference internal" href="model.denoising.model.html#submodules">Submodules</a></li>
<li class="toctree-l2"><a class="reference internal" href="model.denoising.model.html#module-model.denoising.model.distributed">model.denoising.model.distributed module</a><ul>
<li class="toctree-l3"><a class="reference internal" href="model.denoising.model.html#model.denoising.model.distributed.DistributedDataParallel"><code class="docutils literal notranslate"><span class="pre">DistributedDataParallel</span></code></a><ul>
<li class="toctree-l4"><a class="reference internal" href="model.denoising.model.html#model.denoising.model.distributed.DistributedDataParallel.allreduce_gradients"><code class="docutils literal notranslate"><span class="pre">DistributedDataParallel.allreduce_gradients()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="model.denoising.model.html#model.denoising.model.distributed.DistributedDataParallel.zero_grad_buffer"><code class="docutils literal notranslate"><span class="pre">DistributedDataParallel.zero_grad_buffer()</span></code></a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="model.denoising.model.html#model.denoising.model.distributed.DistributedDataParallelBase"><code class="docutils literal notranslate"><span class="pre">DistributedDataParallelBase</span></code></a><ul>
<li class="toctree-l4"><a class="reference internal" href="model.denoising.model.html#model.denoising.model.distributed.DistributedDataParallelBase.allreduce_gradients"><code class="docutils literal notranslate"><span class="pre">DistributedDataParallelBase.allreduce_gradients()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="model.denoising.model.html#model.denoising.model.distributed.DistributedDataParallelBase.forward"><code class="docutils literal notranslate"><span class="pre">DistributedDataParallelBase.forward()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="model.denoising.model.html#model.denoising.model.distributed.DistributedDataParallelBase.load_state_dict"><code class="docutils literal notranslate"><span class="pre">DistributedDataParallelBase.load_state_dict()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="model.denoising.model.html#model.denoising.model.distributed.DistributedDataParallelBase.state_dict"><code class="docutils literal notranslate"><span class="pre">DistributedDataParallelBase.state_dict()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="model.denoising.model.html#model.denoising.model.distributed.DistributedDataParallelBase.state_dict_for_save_checkpoint"><code class="docutils literal notranslate"><span class="pre">DistributedDataParallelBase.state_dict_for_save_checkpoint()</span></code></a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="model.denoising.model.html#model.denoising.model.distributed.MemoryBuffer"><code class="docutils literal notranslate"><span class="pre">MemoryBuffer</span></code></a><ul>
<li class="toctree-l4"><a class="reference internal" href="model.denoising.model.html#model.denoising.model.distributed.MemoryBuffer.get"><code class="docutils literal notranslate"><span class="pre">MemoryBuffer.get()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="model.denoising.model.html#model.denoising.model.distributed.MemoryBuffer.zero"><code class="docutils literal notranslate"><span class="pre">MemoryBuffer.zero()</span></code></a></li>
</ul>
</li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="model.denoising.model.html#module-model.denoising.model.enums">model.denoising.model.enums module</a><ul>
<li class="toctree-l3"><a class="reference internal" href="model.denoising.model.html#model.denoising.model.enums.AttnMaskType"><code class="docutils literal notranslate"><span class="pre">AttnMaskType</span></code></a><ul>
<li class="toctree-l4"><a class="reference internal" href="model.denoising.model.html#model.denoising.model.enums.AttnMaskType.causal"><code class="docutils literal notranslate"><span class="pre">AttnMaskType.causal</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="model.denoising.model.html#model.denoising.model.enums.AttnMaskType.padding"><code class="docutils literal notranslate"><span class="pre">AttnMaskType.padding</span></code></a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="model.denoising.model.html#model.denoising.model.enums.AttnType"><code class="docutils literal notranslate"><span class="pre">AttnType</span></code></a><ul>
<li class="toctree-l4"><a class="reference internal" href="model.denoising.model.html#model.denoising.model.enums.AttnType.cross_attn"><code class="docutils literal notranslate"><span class="pre">AttnType.cross_attn</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="model.denoising.model.html#model.denoising.model.enums.AttnType.self_attn"><code class="docutils literal notranslate"><span class="pre">AttnType.self_attn</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="model.denoising.model.html#model.denoising.model.enums.AttnType.value_conv"><code class="docutils literal notranslate"><span class="pre">AttnType.value_conv</span></code></a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="model.denoising.model.html#model.denoising.model.enums.LayerType"><code class="docutils literal notranslate"><span class="pre">LayerType</span></code></a><ul>
<li class="toctree-l4"><a class="reference internal" href="model.denoising.model.html#model.denoising.model.enums.LayerType.decoder"><code class="docutils literal notranslate"><span class="pre">LayerType.decoder</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="model.denoising.model.html#model.denoising.model.enums.LayerType.encoder"><code class="docutils literal notranslate"><span class="pre">LayerType.encoder</span></code></a></li>
</ul>
</li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="model.denoising.model.html#module-model.denoising.model.fused_bias_gelu">model.denoising.model.fused_bias_gelu module</a><ul>
<li class="toctree-l3"><a class="reference internal" href="model.denoising.model.html#model.denoising.model.fused_bias_gelu.GeLUFunction"><code class="docutils literal notranslate"><span class="pre">GeLUFunction</span></code></a><ul>
<li class="toctree-l4"><a class="reference internal" href="model.denoising.model.html#model.denoising.model.fused_bias_gelu.GeLUFunction.backward"><code class="docutils literal notranslate"><span class="pre">GeLUFunction.backward()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="model.denoising.model.html#model.denoising.model.fused_bias_gelu.GeLUFunction.forward"><code class="docutils literal notranslate"><span class="pre">GeLUFunction.forward()</span></code></a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="model.denoising.model.html#model.denoising.model.fused_bias_gelu.bias_gelu"><code class="docutils literal notranslate"><span class="pre">bias_gelu()</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="model.denoising.model.html#model.denoising.model.fused_bias_gelu.bias_gelu_back"><code class="docutils literal notranslate"><span class="pre">bias_gelu_back()</span></code></a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="model.denoising.model.html#module-model.denoising.model.fused_layer_norm">model.denoising.model.fused_layer_norm module</a><ul>
<li class="toctree-l3"><a class="reference internal" href="model.denoising.model.html#model.denoising.model.fused_layer_norm.FusedLayerNormAffineFunction"><code class="docutils literal notranslate"><span class="pre">FusedLayerNormAffineFunction</span></code></a><ul>
<li class="toctree-l4"><a class="reference internal" href="model.denoising.model.html#model.denoising.model.fused_layer_norm.FusedLayerNormAffineFunction.backward"><code class="docutils literal notranslate"><span class="pre">FusedLayerNormAffineFunction.backward()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="model.denoising.model.html#model.denoising.model.fused_layer_norm.FusedLayerNormAffineFunction.forward"><code class="docutils literal notranslate"><span class="pre">FusedLayerNormAffineFunction.forward()</span></code></a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="model.denoising.model.html#model.denoising.model.fused_layer_norm.MixedFusedLayerNorm"><code class="docutils literal notranslate"><span class="pre">MixedFusedLayerNorm</span></code></a><ul>
<li class="toctree-l4"><a class="reference internal" href="model.denoising.model.html#model.denoising.model.fused_layer_norm.MixedFusedLayerNorm.forward"><code class="docutils literal notranslate"><span class="pre">MixedFusedLayerNorm.forward()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="model.denoising.model.html#model.denoising.model.fused_layer_norm.MixedFusedLayerNorm.reset_parameters"><code class="docutils literal notranslate"><span class="pre">MixedFusedLayerNorm.reset_parameters()</span></code></a></li>
</ul>
</li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="model.denoising.model.html#module-model.denoising.model.fused_softmax">model.denoising.model.fused_softmax module</a><ul>
<li class="toctree-l3"><a class="reference internal" href="model.denoising.model.html#model.denoising.model.fused_softmax.FusedScaleMaskSoftmax"><code class="docutils literal notranslate"><span class="pre">FusedScaleMaskSoftmax</span></code></a><ul>
<li class="toctree-l4"><a class="reference internal" href="model.denoising.model.html#model.denoising.model.fused_softmax.FusedScaleMaskSoftmax.forward"><code class="docutils literal notranslate"><span class="pre">FusedScaleMaskSoftmax.forward()</span></code></a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="model.denoising.model.html#model.denoising.model.fused_softmax.ScaledMaskedSoftmax"><code class="docutils literal notranslate"><span class="pre">ScaledMaskedSoftmax</span></code></a><ul>
<li class="toctree-l4"><a class="reference internal" href="model.denoising.model.html#model.denoising.model.fused_softmax.ScaledMaskedSoftmax.backward"><code class="docutils literal notranslate"><span class="pre">ScaledMaskedSoftmax.backward()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="model.denoising.model.html#model.denoising.model.fused_softmax.ScaledMaskedSoftmax.forward"><code class="docutils literal notranslate"><span class="pre">ScaledMaskedSoftmax.forward()</span></code></a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="model.denoising.model.html#model.denoising.model.fused_softmax.ScaledUpperTriangMaskedSoftmax"><code class="docutils literal notranslate"><span class="pre">ScaledUpperTriangMaskedSoftmax</span></code></a><ul>
<li class="toctree-l4"><a class="reference internal" href="model.denoising.model.html#model.denoising.model.fused_softmax.ScaledUpperTriangMaskedSoftmax.backward"><code class="docutils literal notranslate"><span class="pre">ScaledUpperTriangMaskedSoftmax.backward()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="model.denoising.model.html#model.denoising.model.fused_softmax.ScaledUpperTriangMaskedSoftmax.forward"><code class="docutils literal notranslate"><span class="pre">ScaledUpperTriangMaskedSoftmax.forward()</span></code></a></li>
</ul>
</li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="model.denoising.model.html#module-model.denoising.model.module">model.denoising.model.module module</a><ul>
<li class="toctree-l3"><a class="reference internal" href="model.denoising.model.html#model.denoising.model.module.Float16Module"><code class="docutils literal notranslate"><span class="pre">Float16Module</span></code></a><ul>
<li class="toctree-l4"><a class="reference internal" href="model.denoising.model.html#model.denoising.model.module.Float16Module.forward"><code class="docutils literal notranslate"><span class="pre">Float16Module.forward()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="model.denoising.model.html#model.denoising.model.module.Float16Module.load_state_dict"><code class="docutils literal notranslate"><span class="pre">Float16Module.load_state_dict()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="model.denoising.model.html#model.denoising.model.module.Float16Module.state_dict"><code class="docutils literal notranslate"><span class="pre">Float16Module.state_dict()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="model.denoising.model.html#model.denoising.model.module.Float16Module.state_dict_for_save_checkpoint"><code class="docutils literal notranslate"><span class="pre">Float16Module.state_dict_for_save_checkpoint()</span></code></a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="model.denoising.model.html#model.denoising.model.module.MegatronModule"><code class="docutils literal notranslate"><span class="pre">MegatronModule</span></code></a><ul>
<li class="toctree-l4"><a class="reference internal" href="model.denoising.model.html#model.denoising.model.module.MegatronModule.initialize_word_embeddings"><code class="docutils literal notranslate"><span class="pre">MegatronModule.initialize_word_embeddings()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="model.denoising.model.html#model.denoising.model.module.MegatronModule.state_dict_for_save_checkpoint"><code class="docutils literal notranslate"><span class="pre">MegatronModule.state_dict_for_save_checkpoint()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="model.denoising.model.html#model.denoising.model.module.MegatronModule.word_embeddings_weight"><code class="docutils literal notranslate"><span class="pre">MegatronModule.word_embeddings_weight()</span></code></a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="model.denoising.model.html#model.denoising.model.module.conversion_helper"><code class="docutils literal notranslate"><span class="pre">conversion_helper()</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="model.denoising.model.html#model.denoising.model.module.float16_to_fp32"><code class="docutils literal notranslate"><span class="pre">float16_to_fp32()</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="model.denoising.model.html#model.denoising.model.module.fp32_to_float16"><code class="docutils literal notranslate"><span class="pre">fp32_to_float16()</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="model.denoising.model.html#model.denoising.model.module.param_is_not_shared"><code class="docutils literal notranslate"><span class="pre">param_is_not_shared()</span></code></a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="model.denoising.model.html#module-model.denoising.model.transformer">model.denoising.model.transformer module</a><ul>
<li class="toctree-l3"><a class="reference internal" href="model.denoising.model.html#model.denoising.model.transformer.ParallelAttention"><code class="docutils literal notranslate"><span class="pre">ParallelAttention</span></code></a><ul>
<li class="toctree-l4"><a class="reference internal" href="model.denoising.model.html#model.denoising.model.transformer.ParallelAttention.forward"><code class="docutils literal notranslate"><span class="pre">ParallelAttention.forward()</span></code></a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="model.denoising.model.html#model.denoising.model.transformer.ParallelMLP"><code class="docutils literal notranslate"><span class="pre">ParallelMLP</span></code></a><ul>
<li class="toctree-l4"><a class="reference internal" href="model.denoising.model.html#model.denoising.model.transformer.ParallelMLP.forward"><code class="docutils literal notranslate"><span class="pre">ParallelMLP.forward()</span></code></a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="model.denoising.model.html#model.denoising.model.transformer.ParallelTransformer"><code class="docutils literal notranslate"><span class="pre">ParallelTransformer</span></code></a><ul>
<li class="toctree-l4"><a class="reference internal" href="model.denoising.model.html#model.denoising.model.transformer.ParallelTransformer.forward"><code class="docutils literal notranslate"><span class="pre">ParallelTransformer.forward()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="model.denoising.model.html#model.denoising.model.transformer.ParallelTransformer.set_input_tensor"><code class="docutils literal notranslate"><span class="pre">ParallelTransformer.set_input_tensor()</span></code></a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="model.denoising.model.html#model.denoising.model.transformer.ParallelTransformerLayer"><code class="docutils literal notranslate"><span class="pre">ParallelTransformerLayer</span></code></a><ul>
<li class="toctree-l4"><a class="reference internal" href="model.denoising.model.html#model.denoising.model.transformer.ParallelTransformerLayer.forward"><code class="docutils literal notranslate"><span class="pre">ParallelTransformerLayer.forward()</span></code></a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="model.denoising.model.html#model.denoising.model.transformer.SwiGLU"><code class="docutils literal notranslate"><span class="pre">SwiGLU</span></code></a><ul>
<li class="toctree-l4"><a class="reference internal" href="model.denoising.model.html#model.denoising.model.transformer.SwiGLU.forward"><code class="docutils literal notranslate"><span class="pre">SwiGLU.forward()</span></code></a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="model.denoising.model.html#model.denoising.model.transformer.bias_dropout_add"><code class="docutils literal notranslate"><span class="pre">bias_dropout_add()</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="model.denoising.model.html#model.denoising.model.transformer.bias_dropout_add_fused_inference"><code class="docutils literal notranslate"><span class="pre">bias_dropout_add_fused_inference()</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="model.denoising.model.html#model.denoising.model.transformer.bias_dropout_add_fused_train"><code class="docutils literal notranslate"><span class="pre">bias_dropout_add_fused_train()</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="model.denoising.model.html#model.denoising.model.transformer.get_bias_dropout_add"><code class="docutils literal notranslate"><span class="pre">get_bias_dropout_add()</span></code></a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="model.denoising.model.html#module-model.denoising.model.utils">model.denoising.model.utils module</a><ul>
<li class="toctree-l3"><a class="reference internal" href="model.denoising.model.html#model.denoising.model.utils.attention_mask_func"><code class="docutils literal notranslate"><span class="pre">attention_mask_func()</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="model.denoising.model.html#model.denoising.model.utils.erf_gelu"><code class="docutils literal notranslate"><span class="pre">erf_gelu()</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="model.denoising.model.html#model.denoising.model.utils.gelu_impl"><code class="docutils literal notranslate"><span class="pre">gelu_impl()</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="model.denoising.model.html#model.denoising.model.utils.get_linear_layer"><code class="docutils literal notranslate"><span class="pre">get_linear_layer()</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="model.denoising.model.html#model.denoising.model.utils.init_method_normal"><code class="docutils literal notranslate"><span class="pre">init_method_normal()</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="model.denoising.model.html#model.denoising.model.utils.openai_gelu"><code class="docutils literal notranslate"><span class="pre">openai_gelu()</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="model.denoising.model.html#model.denoising.model.utils.scaled_init_method_normal"><code class="docutils literal notranslate"><span class="pre">scaled_init_method_normal()</span></code></a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="model.denoising.model.html#module-model.denoising.model.waveform_model">model.denoising.model.waveform_model module</a><ul>
<li class="toctree-l3"><a class="reference internal" href="model.denoising.model.html#model.denoising.model.waveform_model.Embedding"><code class="docutils literal notranslate"><span class="pre">Embedding</span></code></a><ul>
<li class="toctree-l4"><a class="reference internal" href="model.denoising.model.html#model.denoising.model.waveform_model.Embedding.forward"><code class="docutils literal notranslate"><span class="pre">Embedding.forward()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="model.denoising.model.html#model.denoising.model.waveform_model.Embedding.load_state_dict"><code class="docutils literal notranslate"><span class="pre">Embedding.load_state_dict()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="model.denoising.model.html#model.denoising.model.waveform_model.Embedding.state_dict_for_save_checkpoint"><code class="docutils literal notranslate"><span class="pre">Embedding.state_dict_for_save_checkpoint()</span></code></a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="model.denoising.model.html#model.denoising.model.waveform_model.Pooler"><code class="docutils literal notranslate"><span class="pre">Pooler</span></code></a><ul>
<li class="toctree-l4"><a class="reference internal" href="model.denoising.model.html#model.denoising.model.waveform_model.Pooler.forward"><code class="docutils literal notranslate"><span class="pre">Pooler.forward()</span></code></a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="model.denoising.model.html#model.denoising.model.waveform_model.TransformerWaveformModel"><code class="docutils literal notranslate"><span class="pre">TransformerWaveformModel</span></code></a><ul>
<li class="toctree-l4"><a class="reference internal" href="model.denoising.model.html#model.denoising.model.waveform_model.TransformerWaveformModel.forward"><code class="docutils literal notranslate"><span class="pre">TransformerWaveformModel.forward()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="model.denoising.model.html#model.denoising.model.waveform_model.TransformerWaveformModel.load_state_dict"><code class="docutils literal notranslate"><span class="pre">TransformerWaveformModel.load_state_dict()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="model.denoising.model.html#model.denoising.model.waveform_model.TransformerWaveformModel.set_input_tensor"><code class="docutils literal notranslate"><span class="pre">TransformerWaveformModel.set_input_tensor()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="model.denoising.model.html#model.denoising.model.waveform_model.TransformerWaveformModel.state_dict_for_save_checkpoint"><code class="docutils literal notranslate"><span class="pre">TransformerWaveformModel.state_dict_for_save_checkpoint()</span></code></a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="model.denoising.model.html#model.denoising.model.waveform_model.get_waveform_model"><code class="docutils literal notranslate"><span class="pre">get_waveform_model()</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="model.denoising.model.html#model.denoising.model.waveform_model.parallel_gw_logits"><code class="docutils literal notranslate"><span class="pre">parallel_gw_logits()</span></code></a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="model.denoising.model.html#module-model.denoising.model.waveformer_model">model.denoising.model.waveformer_model module</a><ul>
<li class="toctree-l3"><a class="reference internal" href="model.denoising.model.html#model.denoising.model.waveformer_model.GWHead"><code class="docutils literal notranslate"><span class="pre">GWHead</span></code></a><ul>
<li class="toctree-l4"><a class="reference internal" href="model.denoising.model.html#model.denoising.model.waveformer_model.GWHead.forward"><code class="docutils literal notranslate"><span class="pre">GWHead.forward()</span></code></a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="model.denoising.model.html#model.denoising.model.waveformer_model.WaveFormerModel"><code class="docutils literal notranslate"><span class="pre">WaveFormerModel</span></code></a><ul>
<li class="toctree-l4"><a class="reference internal" href="model.denoising.model.html#model.denoising.model.waveformer_model.WaveFormerModel.forward"><code class="docutils literal notranslate"><span class="pre">WaveFormerModel.forward()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="model.denoising.model.html#model.denoising.model.waveformer_model.WaveFormerModel.load_state_dict"><code class="docutils literal notranslate"><span class="pre">WaveFormerModel.load_state_dict()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="model.denoising.model.html#model.denoising.model.waveformer_model.WaveFormerModel.set_input_tensor"><code class="docutils literal notranslate"><span class="pre">WaveFormerModel.set_input_tensor()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="model.denoising.model.html#model.denoising.model.waveformer_model.WaveFormerModel.state_dict_for_save_checkpoint"><code class="docutils literal notranslate"><span class="pre">WaveFormerModel.state_dict_for_save_checkpoint()</span></code></a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="model.denoising.model.html#model.denoising.model.waveformer_model.bert_position_ids"><code class="docutils literal notranslate"><span class="pre">bert_position_ids()</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="model.denoising.model.html#model.denoising.model.waveformer_model.gw_extended_attention_mask"><code class="docutils literal notranslate"><span class="pre">gw_extended_attention_mask()</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="model.denoising.model.html#model.denoising.model.waveformer_model.post_waveform_model_processing"><code class="docutils literal notranslate"><span class="pre">post_waveform_model_processing()</span></code></a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="model.denoising.model.html#module-model.denoising.model">Module contents</a></li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="model.denoising.mpu.html">model.denoising.mpu package</a><ul>
<li class="toctree-l2"><a class="reference internal" href="model.denoising.mpu.html#submodules">Submodules</a></li>
<li class="toctree-l2"><a class="reference internal" href="model.denoising.mpu.html#module-model.denoising.mpu.data">model.denoising.mpu.data module</a><ul>
<li class="toctree-l3"><a class="reference internal" href="model.denoising.mpu.html#model.denoising.mpu.data.broadcast_data"><code class="docutils literal notranslate"><span class="pre">broadcast_data()</span></code></a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="model.denoising.mpu.html#module-model.denoising.mpu.initialize">model.denoising.mpu.initialize module</a><ul>
<li class="toctree-l3"><a class="reference internal" href="model.denoising.mpu.html#model.denoising.mpu.initialize.destroy_model_parallel"><code class="docutils literal notranslate"><span class="pre">destroy_model_parallel()</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="model.denoising.mpu.html#model.denoising.mpu.initialize.get_data_parallel_group"><code class="docutils literal notranslate"><span class="pre">get_data_parallel_group()</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="model.denoising.mpu.html#model.denoising.mpu.initialize.get_data_parallel_rank"><code class="docutils literal notranslate"><span class="pre">get_data_parallel_rank()</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="model.denoising.mpu.html#model.denoising.mpu.initialize.get_data_parallel_world_size"><code class="docutils literal notranslate"><span class="pre">get_data_parallel_world_size()</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="model.denoising.mpu.html#model.denoising.mpu.initialize.get_embedding_group"><code class="docutils literal notranslate"><span class="pre">get_embedding_group()</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="model.denoising.mpu.html#model.denoising.mpu.initialize.get_model_parallel_group"><code class="docutils literal notranslate"><span class="pre">get_model_parallel_group()</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="model.denoising.mpu.html#model.denoising.mpu.initialize.get_pipeline_model_parallel_first_rank"><code class="docutils literal notranslate"><span class="pre">get_pipeline_model_parallel_first_rank()</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="model.denoising.mpu.html#model.denoising.mpu.initialize.get_pipeline_model_parallel_group"><code class="docutils literal notranslate"><span class="pre">get_pipeline_model_parallel_group()</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="model.denoising.mpu.html#model.denoising.mpu.initialize.get_pipeline_model_parallel_last_rank"><code class="docutils literal notranslate"><span class="pre">get_pipeline_model_parallel_last_rank()</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="model.denoising.mpu.html#model.denoising.mpu.initialize.get_pipeline_model_parallel_next_rank"><code class="docutils literal notranslate"><span class="pre">get_pipeline_model_parallel_next_rank()</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="model.denoising.mpu.html#model.denoising.mpu.initialize.get_pipeline_model_parallel_prev_rank"><code class="docutils literal notranslate"><span class="pre">get_pipeline_model_parallel_prev_rank()</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="model.denoising.mpu.html#model.denoising.mpu.initialize.get_pipeline_model_parallel_rank"><code class="docutils literal notranslate"><span class="pre">get_pipeline_model_parallel_rank()</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="model.denoising.mpu.html#model.denoising.mpu.initialize.get_pipeline_model_parallel_world_size"><code class="docutils literal notranslate"><span class="pre">get_pipeline_model_parallel_world_size()</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="model.denoising.mpu.html#model.denoising.mpu.initialize.get_tensor_model_parallel_group"><code class="docutils literal notranslate"><span class="pre">get_tensor_model_parallel_group()</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="model.denoising.mpu.html#model.denoising.mpu.initialize.get_tensor_model_parallel_rank"><code class="docutils literal notranslate"><span class="pre">get_tensor_model_parallel_rank()</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="model.denoising.mpu.html#model.denoising.mpu.initialize.get_tensor_model_parallel_src_rank"><code class="docutils literal notranslate"><span class="pre">get_tensor_model_parallel_src_rank()</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="model.denoising.mpu.html#model.denoising.mpu.initialize.get_tensor_model_parallel_world_size"><code class="docutils literal notranslate"><span class="pre">get_tensor_model_parallel_world_size()</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="model.denoising.mpu.html#model.denoising.mpu.initialize.get_virtual_pipeline_model_parallel_rank"><code class="docutils literal notranslate"><span class="pre">get_virtual_pipeline_model_parallel_rank()</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="model.denoising.mpu.html#model.denoising.mpu.initialize.get_virtual_pipeline_model_parallel_world_size"><code class="docutils literal notranslate"><span class="pre">get_virtual_pipeline_model_parallel_world_size()</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="model.denoising.mpu.html#model.denoising.mpu.initialize.initialize_model_parallel"><code class="docutils literal notranslate"><span class="pre">initialize_model_parallel()</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="model.denoising.mpu.html#model.denoising.mpu.initialize.is_pipeline_first_stage"><code class="docutils literal notranslate"><span class="pre">is_pipeline_first_stage()</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="model.denoising.mpu.html#model.denoising.mpu.initialize.is_pipeline_last_stage"><code class="docutils literal notranslate"><span class="pre">is_pipeline_last_stage()</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="model.denoising.mpu.html#model.denoising.mpu.initialize.is_unitialized"><code class="docutils literal notranslate"><span class="pre">is_unitialized()</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="model.denoising.mpu.html#model.denoising.mpu.initialize.model_parallel_is_initialized"><code class="docutils literal notranslate"><span class="pre">model_parallel_is_initialized()</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="model.denoising.mpu.html#model.denoising.mpu.initialize.set_pipeline_model_parallel_rank"><code class="docutils literal notranslate"><span class="pre">set_pipeline_model_parallel_rank()</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="model.denoising.mpu.html#model.denoising.mpu.initialize.set_pipeline_model_parallel_world_size"><code class="docutils literal notranslate"><span class="pre">set_pipeline_model_parallel_world_size()</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="model.denoising.mpu.html#model.denoising.mpu.initialize.set_tensor_model_parallel_rank"><code class="docutils literal notranslate"><span class="pre">set_tensor_model_parallel_rank()</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="model.denoising.mpu.html#model.denoising.mpu.initialize.set_tensor_model_parallel_world_size"><code class="docutils literal notranslate"><span class="pre">set_tensor_model_parallel_world_size()</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="model.denoising.mpu.html#model.denoising.mpu.initialize.set_virtual_pipeline_model_parallel_rank"><code class="docutils literal notranslate"><span class="pre">set_virtual_pipeline_model_parallel_rank()</span></code></a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="model.denoising.mpu.html#module-model.denoising.mpu.layers">model.denoising.mpu.layers module</a><ul>
<li class="toctree-l3"><a class="reference internal" href="model.denoising.mpu.html#model.denoising.mpu.layers.ColumnParallelLinear"><code class="docutils literal notranslate"><span class="pre">ColumnParallelLinear</span></code></a><ul>
<li class="toctree-l4"><a class="reference internal" href="model.denoising.mpu.html#model.denoising.mpu.layers.ColumnParallelLinear.forward"><code class="docutils literal notranslate"><span class="pre">ColumnParallelLinear.forward()</span></code></a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="model.denoising.mpu.html#model.denoising.mpu.layers.RowParallelLinear"><code class="docutils literal notranslate"><span class="pre">RowParallelLinear</span></code></a><ul>
<li class="toctree-l4"><a class="reference internal" href="model.denoising.mpu.html#model.denoising.mpu.layers.RowParallelLinear.forward"><code class="docutils literal notranslate"><span class="pre">RowParallelLinear.forward()</span></code></a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="model.denoising.mpu.html#model.denoising.mpu.layers.VocabParallelEmbedding"><code class="docutils literal notranslate"><span class="pre">VocabParallelEmbedding</span></code></a><ul>
<li class="toctree-l4"><a class="reference internal" href="model.denoising.mpu.html#model.denoising.mpu.layers.VocabParallelEmbedding.forward"><code class="docutils literal notranslate"><span class="pre">VocabParallelEmbedding.forward()</span></code></a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="model.denoising.mpu.html#model.denoising.mpu.layers.copy_tensor_model_parallel_attributes"><code class="docutils literal notranslate"><span class="pre">copy_tensor_model_parallel_attributes()</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="model.denoising.mpu.html#model.denoising.mpu.layers.param_is_not_tensor_parallel_duplicate"><code class="docutils literal notranslate"><span class="pre">param_is_not_tensor_parallel_duplicate()</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="model.denoising.mpu.html#model.denoising.mpu.layers.set_defaults_if_not_set_tensor_model_parallel_attributes"><code class="docutils literal notranslate"><span class="pre">set_defaults_if_not_set_tensor_model_parallel_attributes()</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="model.denoising.mpu.html#model.denoising.mpu.layers.set_tensor_model_parallel_attributes"><code class="docutils literal notranslate"><span class="pre">set_tensor_model_parallel_attributes()</span></code></a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="model.denoising.mpu.html#module-model.denoising.mpu.mappings">model.denoising.mpu.mappings module</a><ul>
<li class="toctree-l3"><a class="reference internal" href="model.denoising.mpu.html#model.denoising.mpu.mappings.copy_to_tensor_model_parallel_region"><code class="docutils literal notranslate"><span class="pre">copy_to_tensor_model_parallel_region()</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="model.denoising.mpu.html#model.denoising.mpu.mappings.gather_from_tensor_model_parallel_region"><code class="docutils literal notranslate"><span class="pre">gather_from_tensor_model_parallel_region()</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="model.denoising.mpu.html#model.denoising.mpu.mappings.reduce_from_tensor_model_parallel_region"><code class="docutils literal notranslate"><span class="pre">reduce_from_tensor_model_parallel_region()</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="model.denoising.mpu.html#model.denoising.mpu.mappings.scatter_to_tensor_model_parallel_region"><code class="docutils literal notranslate"><span class="pre">scatter_to_tensor_model_parallel_region()</span></code></a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="model.denoising.mpu.html#module-model.denoising.mpu.random">model.denoising.mpu.random module</a><ul>
<li class="toctree-l3"><a class="reference internal" href="model.denoising.mpu.html#model.denoising.mpu.random.CheckpointFunction"><code class="docutils literal notranslate"><span class="pre">CheckpointFunction</span></code></a><ul>
<li class="toctree-l4"><a class="reference internal" href="model.denoising.mpu.html#model.denoising.mpu.random.CheckpointFunction.backward"><code class="docutils literal notranslate"><span class="pre">CheckpointFunction.backward()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="model.denoising.mpu.html#model.denoising.mpu.random.CheckpointFunction.forward"><code class="docutils literal notranslate"><span class="pre">CheckpointFunction.forward()</span></code></a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="model.denoising.mpu.html#model.denoising.mpu.random.CudaRNGStatesTracker"><code class="docutils literal notranslate"><span class="pre">CudaRNGStatesTracker</span></code></a><ul>
<li class="toctree-l4"><a class="reference internal" href="model.denoising.mpu.html#model.denoising.mpu.random.CudaRNGStatesTracker.add"><code class="docutils literal notranslate"><span class="pre">CudaRNGStatesTracker.add()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="model.denoising.mpu.html#model.denoising.mpu.random.CudaRNGStatesTracker.fork"><code class="docutils literal notranslate"><span class="pre">CudaRNGStatesTracker.fork()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="model.denoising.mpu.html#model.denoising.mpu.random.CudaRNGStatesTracker.get_states"><code class="docutils literal notranslate"><span class="pre">CudaRNGStatesTracker.get_states()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="model.denoising.mpu.html#model.denoising.mpu.random.CudaRNGStatesTracker.reset"><code class="docutils literal notranslate"><span class="pre">CudaRNGStatesTracker.reset()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="model.denoising.mpu.html#model.denoising.mpu.random.CudaRNGStatesTracker.set_states"><code class="docutils literal notranslate"><span class="pre">CudaRNGStatesTracker.set_states()</span></code></a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="model.denoising.mpu.html#model.denoising.mpu.random.checkpoint"><code class="docutils literal notranslate"><span class="pre">checkpoint()</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="model.denoising.mpu.html#model.denoising.mpu.random.gather_split_1d_tensor"><code class="docutils literal notranslate"><span class="pre">gather_split_1d_tensor()</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="model.denoising.mpu.html#model.denoising.mpu.random.get_cuda_rng_tracker"><code class="docutils literal notranslate"><span class="pre">get_cuda_rng_tracker()</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="model.denoising.mpu.html#model.denoising.mpu.random.init_checkpointed_activations_memory_buffer"><code class="docutils literal notranslate"><span class="pre">init_checkpointed_activations_memory_buffer()</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="model.denoising.mpu.html#model.denoising.mpu.random.model_parallel_cuda_manual_seed"><code class="docutils literal notranslate"><span class="pre">model_parallel_cuda_manual_seed()</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="model.denoising.mpu.html#model.denoising.mpu.random.reset_checkpointed_activations_memory_buffer"><code class="docutils literal notranslate"><span class="pre">reset_checkpointed_activations_memory_buffer()</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="model.denoising.mpu.html#model.denoising.mpu.random.split_tensor_into_1d_equal_chunks"><code class="docutils literal notranslate"><span class="pre">split_tensor_into_1d_equal_chunks()</span></code></a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="model.denoising.mpu.html#module-model.denoising.mpu.utils">model.denoising.mpu.utils module</a><ul>
<li class="toctree-l3"><a class="reference internal" href="model.denoising.mpu.html#model.denoising.mpu.utils.VocabUtility"><code class="docutils literal notranslate"><span class="pre">VocabUtility</span></code></a><ul>
<li class="toctree-l4"><a class="reference internal" href="model.denoising.mpu.html#model.denoising.mpu.utils.VocabUtility.vocab_range_from_global_vocab_size"><code class="docutils literal notranslate"><span class="pre">VocabUtility.vocab_range_from_global_vocab_size()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="model.denoising.mpu.html#model.denoising.mpu.utils.VocabUtility.vocab_range_from_per_partition_vocab_size"><code class="docutils literal notranslate"><span class="pre">VocabUtility.vocab_range_from_per_partition_vocab_size()</span></code></a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="model.denoising.mpu.html#model.denoising.mpu.utils.divide"><code class="docutils literal notranslate"><span class="pre">divide()</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="model.denoising.mpu.html#model.denoising.mpu.utils.ensure_divisibility"><code class="docutils literal notranslate"><span class="pre">ensure_divisibility()</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="model.denoising.mpu.html#model.denoising.mpu.utils.split_tensor_along_last_dim"><code class="docutils literal notranslate"><span class="pre">split_tensor_along_last_dim()</span></code></a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="model.denoising.mpu.html#module-model.denoising.mpu">Module contents</a></li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="model.denoising.optimizer.html">model.denoising.optimizer package</a><ul>
<li class="toctree-l2"><a class="reference internal" href="model.denoising.optimizer.html#submodules">Submodules</a></li>
<li class="toctree-l2"><a class="reference internal" href="model.denoising.optimizer.html#module-model.denoising.optimizer.clip_grads">model.denoising.optimizer.clip_grads module</a><ul>
<li class="toctree-l3"><a class="reference internal" href="model.denoising.optimizer.html#model.denoising.optimizer.clip_grads.clip_grad_norm_fp32"><code class="docutils literal notranslate"><span class="pre">clip_grad_norm_fp32()</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="model.denoising.optimizer.html#model.denoising.optimizer.clip_grads.count_zeros_fp32"><code class="docutils literal notranslate"><span class="pre">count_zeros_fp32()</span></code></a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="model.denoising.optimizer.html#module-model.denoising.optimizer.grad_scaler">model.denoising.optimizer.grad_scaler module</a><ul>
<li class="toctree-l3"><a class="reference internal" href="model.denoising.optimizer.html#model.denoising.optimizer.grad_scaler.ConstantGradScaler"><code class="docutils literal notranslate"><span class="pre">ConstantGradScaler</span></code></a><ul>
<li class="toctree-l4"><a class="reference internal" href="model.denoising.optimizer.html#model.denoising.optimizer.grad_scaler.ConstantGradScaler.load_state_dict"><code class="docutils literal notranslate"><span class="pre">ConstantGradScaler.load_state_dict()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="model.denoising.optimizer.html#model.denoising.optimizer.grad_scaler.ConstantGradScaler.state_dict"><code class="docutils literal notranslate"><span class="pre">ConstantGradScaler.state_dict()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="model.denoising.optimizer.html#model.denoising.optimizer.grad_scaler.ConstantGradScaler.update"><code class="docutils literal notranslate"><span class="pre">ConstantGradScaler.update()</span></code></a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="model.denoising.optimizer.html#model.denoising.optimizer.grad_scaler.DynamicGradScaler"><code class="docutils literal notranslate"><span class="pre">DynamicGradScaler</span></code></a><ul>
<li class="toctree-l4"><a class="reference internal" href="model.denoising.optimizer.html#model.denoising.optimizer.grad_scaler.DynamicGradScaler.load_state_dict"><code class="docutils literal notranslate"><span class="pre">DynamicGradScaler.load_state_dict()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="model.denoising.optimizer.html#model.denoising.optimizer.grad_scaler.DynamicGradScaler.state_dict"><code class="docutils literal notranslate"><span class="pre">DynamicGradScaler.state_dict()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="model.denoising.optimizer.html#model.denoising.optimizer.grad_scaler.DynamicGradScaler.update"><code class="docutils literal notranslate"><span class="pre">DynamicGradScaler.update()</span></code></a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="model.denoising.optimizer.html#model.denoising.optimizer.grad_scaler.MegatronGradScaler"><code class="docutils literal notranslate"><span class="pre">MegatronGradScaler</span></code></a><ul>
<li class="toctree-l4"><a class="reference internal" href="model.denoising.optimizer.html#model.denoising.optimizer.grad_scaler.MegatronGradScaler.inv_scale"><code class="docutils literal notranslate"><span class="pre">MegatronGradScaler.inv_scale</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="model.denoising.optimizer.html#model.denoising.optimizer.grad_scaler.MegatronGradScaler.load_state_dict"><code class="docutils literal notranslate"><span class="pre">MegatronGradScaler.load_state_dict()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="model.denoising.optimizer.html#model.denoising.optimizer.grad_scaler.MegatronGradScaler.scale"><code class="docutils literal notranslate"><span class="pre">MegatronGradScaler.scale</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="model.denoising.optimizer.html#model.denoising.optimizer.grad_scaler.MegatronGradScaler.state_dict"><code class="docutils literal notranslate"><span class="pre">MegatronGradScaler.state_dict()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="model.denoising.optimizer.html#model.denoising.optimizer.grad_scaler.MegatronGradScaler.update"><code class="docutils literal notranslate"><span class="pre">MegatronGradScaler.update()</span></code></a></li>
</ul>
</li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="model.denoising.optimizer.html#module-model.denoising.optimizer.optimizer">model.denoising.optimizer.optimizer module</a><ul>
<li class="toctree-l3"><a class="reference internal" href="model.denoising.optimizer.html#model.denoising.optimizer.optimizer.FP32Optimizer"><code class="docutils literal notranslate"><span class="pre">FP32Optimizer</span></code></a><ul>
<li class="toctree-l4"><a class="reference internal" href="model.denoising.optimizer.html#model.denoising.optimizer.optimizer.FP32Optimizer.get_loss_scale"><code class="docutils literal notranslate"><span class="pre">FP32Optimizer.get_loss_scale()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="model.denoising.optimizer.html#model.denoising.optimizer.optimizer.FP32Optimizer.load_state_dict"><code class="docutils literal notranslate"><span class="pre">FP32Optimizer.load_state_dict()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="model.denoising.optimizer.html#model.denoising.optimizer.optimizer.FP32Optimizer.reload_model_params"><code class="docutils literal notranslate"><span class="pre">FP32Optimizer.reload_model_params()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="model.denoising.optimizer.html#model.denoising.optimizer.optimizer.FP32Optimizer.state_dict"><code class="docutils literal notranslate"><span class="pre">FP32Optimizer.state_dict()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="model.denoising.optimizer.html#model.denoising.optimizer.optimizer.FP32Optimizer.step"><code class="docutils literal notranslate"><span class="pre">FP32Optimizer.step()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="model.denoising.optimizer.html#model.denoising.optimizer.optimizer.FP32Optimizer.zero_grad"><code class="docutils literal notranslate"><span class="pre">FP32Optimizer.zero_grad()</span></code></a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="model.denoising.optimizer.html#model.denoising.optimizer.optimizer.Float16OptimizerWithFloat16Params"><code class="docutils literal notranslate"><span class="pre">Float16OptimizerWithFloat16Params</span></code></a><ul>
<li class="toctree-l4"><a class="reference internal" href="model.denoising.optimizer.html#model.denoising.optimizer.optimizer.Float16OptimizerWithFloat16Params.get_loss_scale"><code class="docutils literal notranslate"><span class="pre">Float16OptimizerWithFloat16Params.get_loss_scale()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="model.denoising.optimizer.html#model.denoising.optimizer.optimizer.Float16OptimizerWithFloat16Params.load_state_dict"><code class="docutils literal notranslate"><span class="pre">Float16OptimizerWithFloat16Params.load_state_dict()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="model.denoising.optimizer.html#model.denoising.optimizer.optimizer.Float16OptimizerWithFloat16Params.reload_model_params"><code class="docutils literal notranslate"><span class="pre">Float16OptimizerWithFloat16Params.reload_model_params()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="model.denoising.optimizer.html#model.denoising.optimizer.optimizer.Float16OptimizerWithFloat16Params.state_dict"><code class="docutils literal notranslate"><span class="pre">Float16OptimizerWithFloat16Params.state_dict()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="model.denoising.optimizer.html#model.denoising.optimizer.optimizer.Float16OptimizerWithFloat16Params.step"><code class="docutils literal notranslate"><span class="pre">Float16OptimizerWithFloat16Params.step()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="model.denoising.optimizer.html#model.denoising.optimizer.optimizer.Float16OptimizerWithFloat16Params.zero_grad"><code class="docutils literal notranslate"><span class="pre">Float16OptimizerWithFloat16Params.zero_grad()</span></code></a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="model.denoising.optimizer.html#model.denoising.optimizer.optimizer.MegatronOptimizer"><code class="docutils literal notranslate"><span class="pre">MegatronOptimizer</span></code></a><ul>
<li class="toctree-l4"><a class="reference internal" href="model.denoising.optimizer.html#model.denoising.optimizer.optimizer.MegatronOptimizer.clip_grad_norm"><code class="docutils literal notranslate"><span class="pre">MegatronOptimizer.clip_grad_norm()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="model.denoising.optimizer.html#model.denoising.optimizer.optimizer.MegatronOptimizer.count_zeros"><code class="docutils literal notranslate"><span class="pre">MegatronOptimizer.count_zeros()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="model.denoising.optimizer.html#model.denoising.optimizer.optimizer.MegatronOptimizer.get_loss_scale"><code class="docutils literal notranslate"><span class="pre">MegatronOptimizer.get_loss_scale()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="model.denoising.optimizer.html#model.denoising.optimizer.optimizer.MegatronOptimizer.get_parameters"><code class="docutils literal notranslate"><span class="pre">MegatronOptimizer.get_parameters()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="model.denoising.optimizer.html#model.denoising.optimizer.optimizer.MegatronOptimizer.load_state_dict"><code class="docutils literal notranslate"><span class="pre">MegatronOptimizer.load_state_dict()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="model.denoising.optimizer.html#model.denoising.optimizer.optimizer.MegatronOptimizer.param_groups"><code class="docutils literal notranslate"><span class="pre">MegatronOptimizer.param_groups</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="model.denoising.optimizer.html#model.denoising.optimizer.optimizer.MegatronOptimizer.reload_model_params"><code class="docutils literal notranslate"><span class="pre">MegatronOptimizer.reload_model_params()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="model.denoising.optimizer.html#model.denoising.optimizer.optimizer.MegatronOptimizer.scale_loss"><code class="docutils literal notranslate"><span class="pre">MegatronOptimizer.scale_loss()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="model.denoising.optimizer.html#model.denoising.optimizer.optimizer.MegatronOptimizer.state"><code class="docutils literal notranslate"><span class="pre">MegatronOptimizer.state</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="model.denoising.optimizer.html#model.denoising.optimizer.optimizer.MegatronOptimizer.state_dict"><code class="docutils literal notranslate"><span class="pre">MegatronOptimizer.state_dict()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="model.denoising.optimizer.html#model.denoising.optimizer.optimizer.MegatronOptimizer.step"><code class="docutils literal notranslate"><span class="pre">MegatronOptimizer.step()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="model.denoising.optimizer.html#model.denoising.optimizer.optimizer.MegatronOptimizer.zero_grad"><code class="docutils literal notranslate"><span class="pre">MegatronOptimizer.zero_grad()</span></code></a></li>
</ul>
</li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="model.denoising.optimizer.html#module-model.denoising.optimizer">Module contents</a><ul>
<li class="toctree-l3"><a class="reference internal" href="model.denoising.optimizer.html#model.denoising.optimizer.get_megatron_optimizer"><code class="docutils literal notranslate"><span class="pre">get_megatron_optimizer()</span></code></a></li>
</ul>
</li>
</ul>
</li>
</ul>
</div>
</section>
<section id="submodules">
<h2>Submodules<a class="headerlink" href="#submodules" title="Link to this heading"></a></h2>
</section>
<section id="module-model.denoising.arguments">
<span id="model-denoising-arguments-module"></span><h2>model.denoising.arguments module<a class="headerlink" href="#module-model.denoising.arguments" title="Link to this heading"></a></h2>
<p>Megatron arguments.</p>
<dl class="py function">
<dt class="sig sig-object py" id="model.denoising.arguments.parse_args">
<span class="sig-prename descclassname"><span class="pre">model.denoising.arguments.</span></span><span class="sig-name descname"><span class="pre">parse_args</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">extra_args_provider</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">defaults</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">{}</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">ignore_unknown_args</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#model.denoising.arguments.parse_args" title="Link to this definition"></a></dt>
<dd><p>Parse all arguments.</p>
</dd></dl>

</section>
<section id="module-model.denoising.checkpointing">
<span id="model-denoising-checkpointing-module"></span><h2>model.denoising.checkpointing module<a class="headerlink" href="#module-model.denoising.checkpointing" title="Link to this heading"></a></h2>
<p>Input/output checkpointing.</p>
<dl class="py function">
<dt class="sig sig-object py" id="model.denoising.checkpointing.check_checkpoint_args">
<span class="sig-prename descclassname"><span class="pre">model.denoising.checkpointing.</span></span><span class="sig-name descname"><span class="pre">check_checkpoint_args</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">checkpoint_args</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#model.denoising.checkpointing.check_checkpoint_args" title="Link to this definition"></a></dt>
<dd><p>Ensure fixed arguments for a model are the same for the input
arguments and the one retrieved from checkpoint.</p>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="model.denoising.checkpointing.ensure_directory_exists">
<span class="sig-prename descclassname"><span class="pre">model.denoising.checkpointing.</span></span><span class="sig-name descname"><span class="pre">ensure_directory_exists</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">filename</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#model.denoising.checkpointing.ensure_directory_exists" title="Link to this definition"></a></dt>
<dd><p>Build filename’s path if it does not already exists.</p>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="model.denoising.checkpointing.fix_query_key_value_ordering">
<span class="sig-prename descclassname"><span class="pre">model.denoising.checkpointing.</span></span><span class="sig-name descname"><span class="pre">fix_query_key_value_ordering</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">model</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">checkpoint_version</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#model.denoising.checkpointing.fix_query_key_value_ordering" title="Link to this definition"></a></dt>
<dd><p>Fix up query/key/value matrix ordering if checkpoint
version is smaller than 2.0</p>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="model.denoising.checkpointing.get_checkpoint_name">
<span class="sig-prename descclassname"><span class="pre">model.denoising.checkpointing.</span></span><span class="sig-name descname"><span class="pre">get_checkpoint_name</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">checkpoints_path</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">iteration</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">release</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#model.denoising.checkpointing.get_checkpoint_name" title="Link to this definition"></a></dt>
<dd><p>A unified checkpoint name.</p>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="model.denoising.checkpointing.get_checkpoint_tracker_filename">
<span class="sig-prename descclassname"><span class="pre">model.denoising.checkpointing.</span></span><span class="sig-name descname"><span class="pre">get_checkpoint_tracker_filename</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">checkpoints_path</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#model.denoising.checkpointing.get_checkpoint_tracker_filename" title="Link to this definition"></a></dt>
<dd><p>Tracker file rescords the latest chckpoint during
training to restart from.</p>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="model.denoising.checkpointing.get_checkpoint_version">
<span class="sig-prename descclassname"><span class="pre">model.denoising.checkpointing.</span></span><span class="sig-name descname"><span class="pre">get_checkpoint_version</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#model.denoising.checkpointing.get_checkpoint_version" title="Link to this definition"></a></dt>
<dd></dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="model.denoising.checkpointing.load_biencoder_checkpoint">
<span class="sig-prename descclassname"><span class="pre">model.denoising.checkpointing.</span></span><span class="sig-name descname"><span class="pre">load_biencoder_checkpoint</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">model</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">only_query_model</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">only_context_model</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">custom_load_path</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#model.denoising.checkpointing.load_biencoder_checkpoint" title="Link to this definition"></a></dt>
<dd><p>selectively load retrieval models for indexing/retrieving
from saved checkpoints</p>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="model.denoising.checkpointing.load_checkpoint">
<span class="sig-prename descclassname"><span class="pre">model.denoising.checkpointing.</span></span><span class="sig-name descname"><span class="pre">load_checkpoint</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">model</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">optimizer</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">lr_scheduler</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">load_arg</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'load'</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">strict</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">True</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#model.denoising.checkpointing.load_checkpoint" title="Link to this definition"></a></dt>
<dd><p>Load a model checkpoint and return the iteration.
strict (bool): whether to strictly enforce that the keys in</p>
<blockquote>
<div><p><code class="xref py py-attr docutils literal notranslate"><span class="pre">state_dict</span></code> of the checkpoint match the names of
parameters and buffers in model.</p>
</div></blockquote>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="model.denoising.checkpointing.save_checkpoint">
<span class="sig-prename descclassname"><span class="pre">model.denoising.checkpointing.</span></span><span class="sig-name descname"><span class="pre">save_checkpoint</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">iteration</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">model</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">optimizer</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">lr_scheduler</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#model.denoising.checkpointing.save_checkpoint" title="Link to this definition"></a></dt>
<dd><p>Save a model checkpoint.</p>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="model.denoising.checkpointing.set_checkpoint_version">
<span class="sig-prename descclassname"><span class="pre">model.denoising.checkpointing.</span></span><span class="sig-name descname"><span class="pre">set_checkpoint_version</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">value</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#model.denoising.checkpointing.set_checkpoint_version" title="Link to this definition"></a></dt>
<dd></dd></dl>

</section>
<section id="module-model.denoising.global_vars">
<span id="model-denoising-global-vars-module"></span><h2>model.denoising.global_vars module<a class="headerlink" href="#module-model.denoising.global_vars" title="Link to this heading"></a></h2>
<p>Megatron global variables.</p>
<dl class="py class">
<dt class="sig sig-object py" id="model.denoising.global_vars.Timers">
<em class="property"><span class="pre">class</span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">model.denoising.global_vars.</span></span><span class="sig-name descname"><span class="pre">Timers</span></span><a class="headerlink" href="#model.denoising.global_vars.Timers" title="Link to this definition"></a></dt>
<dd><p>Bases: <code class="xref py py-class docutils literal notranslate"><span class="pre">object</span></code></p>
<p>Group of timers.</p>
<dl class="py method">
<dt class="sig sig-object py" id="model.denoising.global_vars.Timers.log">
<span class="sig-name descname"><span class="pre">log</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">names</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">normalizer</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">1.0</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">reset</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">True</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#model.denoising.global_vars.Timers.log" title="Link to this definition"></a></dt>
<dd><p>Log a group of timers.</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="model.denoising.global_vars.Timers.write">
<span class="sig-name descname"><span class="pre">write</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">names</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">writer</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">iteration</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">normalizer</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">1.0</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">reset</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#model.denoising.global_vars.Timers.write" title="Link to this definition"></a></dt>
<dd><p>Write timers to a tensorboard writer</p>
</dd></dl>

</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="model.denoising.global_vars.get_adlr_autoresume">
<span class="sig-prename descclassname"><span class="pre">model.denoising.global_vars.</span></span><span class="sig-name descname"><span class="pre">get_adlr_autoresume</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#model.denoising.global_vars.get_adlr_autoresume" title="Link to this definition"></a></dt>
<dd><p>ADLR autoresume object. It can be None so no need
to check if it is initialized.</p>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="model.denoising.global_vars.get_args">
<span class="sig-prename descclassname"><span class="pre">model.denoising.global_vars.</span></span><span class="sig-name descname"><span class="pre">get_args</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#model.denoising.global_vars.get_args" title="Link to this definition"></a></dt>
<dd><p>Return arguments.</p>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="model.denoising.global_vars.get_current_global_batch_size">
<span class="sig-prename descclassname"><span class="pre">model.denoising.global_vars.</span></span><span class="sig-name descname"><span class="pre">get_current_global_batch_size</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#model.denoising.global_vars.get_current_global_batch_size" title="Link to this definition"></a></dt>
<dd></dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="model.denoising.global_vars.get_num_microbatches">
<span class="sig-prename descclassname"><span class="pre">model.denoising.global_vars.</span></span><span class="sig-name descname"><span class="pre">get_num_microbatches</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#model.denoising.global_vars.get_num_microbatches" title="Link to this definition"></a></dt>
<dd></dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="model.denoising.global_vars.get_tensorboard_writer">
<span class="sig-prename descclassname"><span class="pre">model.denoising.global_vars.</span></span><span class="sig-name descname"><span class="pre">get_tensorboard_writer</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#model.denoising.global_vars.get_tensorboard_writer" title="Link to this definition"></a></dt>
<dd><p>Return tensorboard writer. It can be None so no need
to check if it is initialized.</p>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="model.denoising.global_vars.get_timers">
<span class="sig-prename descclassname"><span class="pre">model.denoising.global_vars.</span></span><span class="sig-name descname"><span class="pre">get_timers</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#model.denoising.global_vars.get_timers" title="Link to this definition"></a></dt>
<dd><p>Return timers.</p>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="model.denoising.global_vars.get_tokenizer">
<span class="sig-prename descclassname"><span class="pre">model.denoising.global_vars.</span></span><span class="sig-name descname"><span class="pre">get_tokenizer</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#model.denoising.global_vars.get_tokenizer" title="Link to this definition"></a></dt>
<dd><p>Return tokenizer.</p>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="model.denoising.global_vars.set_global_variables">
<span class="sig-prename descclassname"><span class="pre">model.denoising.global_vars.</span></span><span class="sig-name descname"><span class="pre">set_global_variables</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">extra_args_provider</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">args_defaults</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">{}</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">ignore_unknown_args</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#model.denoising.global_vars.set_global_variables" title="Link to this definition"></a></dt>
<dd><p>Set args, tokenizer, tensorboard-writer, adlr-autoresume, and timers.</p>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="model.denoising.global_vars.update_num_microbatches">
<span class="sig-prename descclassname"><span class="pre">model.denoising.global_vars.</span></span><span class="sig-name descname"><span class="pre">update_num_microbatches</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">consumed_samples</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">consistency_check</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">True</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#model.denoising.global_vars.update_num_microbatches" title="Link to this definition"></a></dt>
<dd></dd></dl>

</section>
<section id="module-model.denoising.initialize">
<span id="model-denoising-initialize-module"></span><h2>model.denoising.initialize module<a class="headerlink" href="#module-model.denoising.initialize" title="Link to this heading"></a></h2>
<p>Megatron initialization.</p>
<dl class="py function">
<dt class="sig sig-object py" id="model.denoising.initialize.initialize_megatron">
<span class="sig-prename descclassname"><span class="pre">model.denoising.initialize.</span></span><span class="sig-name descname"><span class="pre">initialize_megatron</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">extra_args_provider</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">args_defaults</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">{}</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">ignore_unknown_args</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">allow_no_cuda</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#model.denoising.initialize.initialize_megatron" title="Link to this definition"></a></dt>
<dd><p>Set global variables, initialize distributed, and
set autoresume and random seeds.
<cite>allow_no_cuda</cite> should not be set unless using megatron for cpu only
data processing. In general this arg should not be set unless you know
what you are doing.
Returns a function to finalize distributed env initialization
(optionally, only when args.lazy_mpu_init == True)</p>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="model.denoising.initialize.write_args_to_tensorboard">
<span class="sig-prename descclassname"><span class="pre">model.denoising.initialize.</span></span><span class="sig-name descname"><span class="pre">write_args_to_tensorboard</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#model.denoising.initialize.write_args_to_tensorboard" title="Link to this definition"></a></dt>
<dd><p>Write arguments to tensorboard.</p>
</dd></dl>

</section>
<section id="module-model.denoising.learning_rates">
<span id="model-denoising-learning-rates-module"></span><h2>model.denoising.learning_rates module<a class="headerlink" href="#module-model.denoising.learning_rates" title="Link to this heading"></a></h2>
<p>Learning rate decay functions.</p>
<dl class="py class">
<dt class="sig sig-object py" id="model.denoising.learning_rates.AnnealingLR">
<em class="property"><span class="pre">class</span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">model.denoising.learning_rates.</span></span><span class="sig-name descname"><span class="pre">AnnealingLR</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">optimizer</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">max_lr</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">min_lr</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">warmup_steps</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">decay_steps</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">decay_style</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">use_checkpoint_lr_scheduler</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">True</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">override_lr_scheduler</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#model.denoising.learning_rates.AnnealingLR" title="Link to this definition"></a></dt>
<dd><p>Bases: <code class="xref py py-class docutils literal notranslate"><span class="pre">object</span></code></p>
<p>Anneals the learning rate.</p>
<dl class="py method">
<dt class="sig sig-object py" id="model.denoising.learning_rates.AnnealingLR.get_lr">
<span class="sig-name descname"><span class="pre">get_lr</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#model.denoising.learning_rates.AnnealingLR.get_lr" title="Link to this definition"></a></dt>
<dd><p>Learning rate decay functions from:
<a class="reference external" href="https://openreview.net/pdf?id=BJYwwY9ll">https://openreview.net/pdf?id=BJYwwY9ll</a> pg. 4</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="model.denoising.learning_rates.AnnealingLR.load_state_dict">
<span class="sig-name descname"><span class="pre">load_state_dict</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">sd</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#model.denoising.learning_rates.AnnealingLR.load_state_dict" title="Link to this definition"></a></dt>
<dd></dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="model.denoising.learning_rates.AnnealingLR.state_dict">
<span class="sig-name descname"><span class="pre">state_dict</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#model.denoising.learning_rates.AnnealingLR.state_dict" title="Link to this definition"></a></dt>
<dd></dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="model.denoising.learning_rates.AnnealingLR.step">
<span class="sig-name descname"><span class="pre">step</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">increment</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#model.denoising.learning_rates.AnnealingLR.step" title="Link to this definition"></a></dt>
<dd><p>Set lr for all parameters groups.</p>
</dd></dl>

</dd></dl>

</section>
<section id="module-model.denoising.memory">
<span id="model-denoising-memory-module"></span><h2>model.denoising.memory module<a class="headerlink" href="#module-model.denoising.memory" title="Link to this heading"></a></h2>
<dl class="py class">
<dt class="sig sig-object py" id="model.denoising.memory.MemoryBuffer">
<em class="property"><span class="pre">class</span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">model.denoising.memory.</span></span><span class="sig-name descname"><span class="pre">MemoryBuffer</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">name</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">numel</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">dtype</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">track_usage</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#model.denoising.memory.MemoryBuffer" title="Link to this definition"></a></dt>
<dd><p>Bases: <code class="xref py py-class docutils literal notranslate"><span class="pre">object</span></code></p>
<p>Contiguous memory buffer.
Allocate a contiguous memory of type <cite>dtype</cite> and size <cite>numel</cite>. It is
used to reduce memory fragmentation.</p>
<dl class="simple">
<dt>Usage: After the allocation, the <cite>_start</cite> index is set tot the first</dt><dd><p>index of the memory. A memory chunk starting from <cite>_start</cite> index
can be <cite>allocated</cite> for an input tensor, with the elements of the
tensor being coppied. The buffer can be reused by resetting the
<cite>_start</cite> index.</p>
</dd>
</dl>
<dl class="py method">
<dt class="sig sig-object py" id="model.denoising.memory.MemoryBuffer.add">
<span class="sig-name descname"><span class="pre">add</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">tensor</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#model.denoising.memory.MemoryBuffer.add" title="Link to this definition"></a></dt>
<dd><p>Allocate a chunk of memory from the buffer to tensor and copy
the values.</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="model.denoising.memory.MemoryBuffer.get_data">
<span class="sig-name descname"><span class="pre">get_data</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#model.denoising.memory.MemoryBuffer.get_data" title="Link to this definition"></a></dt>
<dd><p>Return the data currently in use.</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="model.denoising.memory.MemoryBuffer.is_in_use">
<span class="sig-name descname"><span class="pre">is_in_use</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#model.denoising.memory.MemoryBuffer.is_in_use" title="Link to this definition"></a></dt>
<dd><p>Whether the current buffer hold on to any memory.</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="model.denoising.memory.MemoryBuffer.numel_in_use">
<span class="sig-name descname"><span class="pre">numel_in_use</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#model.denoising.memory.MemoryBuffer.numel_in_use" title="Link to this definition"></a></dt>
<dd><p>Return number of elements in use.</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="model.denoising.memory.MemoryBuffer.print_average_usage">
<span class="sig-name descname"><span class="pre">print_average_usage</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#model.denoising.memory.MemoryBuffer.print_average_usage" title="Link to this definition"></a></dt>
<dd><p>Print memory usage average over time. We would like this value
to be as high as possible.</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="model.denoising.memory.MemoryBuffer.reset">
<span class="sig-name descname"><span class="pre">reset</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#model.denoising.memory.MemoryBuffer.reset" title="Link to this definition"></a></dt>
<dd><p>Reset the buffer start index to the beginning of the buffer.</p>
</dd></dl>

</dd></dl>

<dl class="py class">
<dt class="sig sig-object py" id="model.denoising.memory.RingMemBuffer">
<em class="property"><span class="pre">class</span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">model.denoising.memory.</span></span><span class="sig-name descname"><span class="pre">RingMemBuffer</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">name</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">num_buffers</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">numel</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">dtype</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">track_usage</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#model.denoising.memory.RingMemBuffer" title="Link to this definition"></a></dt>
<dd><p>Bases: <code class="xref py py-class docutils literal notranslate"><span class="pre">object</span></code></p>
<p>A ring of memory buffers.</p>
<dl class="py method">
<dt class="sig sig-object py" id="model.denoising.memory.RingMemBuffer.get_next_buffer">
<span class="sig-name descname"><span class="pre">get_next_buffer</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#model.denoising.memory.RingMemBuffer.get_next_buffer" title="Link to this definition"></a></dt>
<dd></dd></dl>

</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="model.denoising.memory.allocate_mem_buff">
<span class="sig-prename descclassname"><span class="pre">model.denoising.memory.</span></span><span class="sig-name descname"><span class="pre">allocate_mem_buff</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">name</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">numel</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">dtype</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">track_usage</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#model.denoising.memory.allocate_mem_buff" title="Link to this definition"></a></dt>
<dd><p>Allocate a memory buffer.</p>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="model.denoising.memory.get_mem_buff">
<span class="sig-prename descclassname"><span class="pre">model.denoising.memory.</span></span><span class="sig-name descname"><span class="pre">get_mem_buff</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">name</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#model.denoising.memory.get_mem_buff" title="Link to this definition"></a></dt>
<dd><p>Get the memory buffer.</p>
</dd></dl>

</section>
<section id="module-model.denoising.microbatches">
<span id="model-denoising-microbatches-module"></span><h2>model.denoising.microbatches module<a class="headerlink" href="#module-model.denoising.microbatches" title="Link to this heading"></a></h2>
<p>Megatron number of micro-batches calculators.</p>
<dl class="py class">
<dt class="sig sig-object py" id="model.denoising.microbatches.ConstantNumMicroBatches">
<em class="property"><span class="pre">class</span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">model.denoising.microbatches.</span></span><span class="sig-name descname"><span class="pre">ConstantNumMicroBatches</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">global_batch_size</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">micro_batch_size</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">data_parallel_size</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#model.denoising.microbatches.ConstantNumMicroBatches" title="Link to this definition"></a></dt>
<dd><p>Bases: <a class="reference internal" href="#model.denoising.microbatches.NumMicroBatchesCalculator" title="model.denoising.microbatches.NumMicroBatchesCalculator"><code class="xref py py-class docutils literal notranslate"><span class="pre">NumMicroBatchesCalculator</span></code></a></p>
<dl class="py method">
<dt class="sig sig-object py" id="model.denoising.microbatches.ConstantNumMicroBatches.update">
<span class="sig-name descname"><span class="pre">update</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">consumed_samples</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">consistency_check</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#model.denoising.microbatches.ConstantNumMicroBatches.update" title="Link to this definition"></a></dt>
<dd></dd></dl>

</dd></dl>

<dl class="py class">
<dt class="sig sig-object py" id="model.denoising.microbatches.NumMicroBatchesCalculator">
<em class="property"><span class="pre">class</span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">model.denoising.microbatches.</span></span><span class="sig-name descname"><span class="pre">NumMicroBatchesCalculator</span></span><a class="headerlink" href="#model.denoising.microbatches.NumMicroBatchesCalculator" title="Link to this definition"></a></dt>
<dd><p>Bases: <code class="xref py py-class docutils literal notranslate"><span class="pre">ABC</span></code></p>
<dl class="py method">
<dt class="sig sig-object py" id="model.denoising.microbatches.NumMicroBatchesCalculator.get">
<span class="sig-name descname"><span class="pre">get</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#model.denoising.microbatches.NumMicroBatchesCalculator.get" title="Link to this definition"></a></dt>
<dd></dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="model.denoising.microbatches.NumMicroBatchesCalculator.get_current_global_batch_size">
<span class="sig-name descname"><span class="pre">get_current_global_batch_size</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#model.denoising.microbatches.NumMicroBatchesCalculator.get_current_global_batch_size" title="Link to this definition"></a></dt>
<dd></dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="model.denoising.microbatches.NumMicroBatchesCalculator.update">
<em class="property"><span class="pre">abstract</span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">update</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">consumed_samples</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">consistency_check</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#model.denoising.microbatches.NumMicroBatchesCalculator.update" title="Link to this definition"></a></dt>
<dd></dd></dl>

</dd></dl>

<dl class="py class">
<dt class="sig sig-object py" id="model.denoising.microbatches.RampupBatchsizeNumMicroBatches">
<em class="property"><span class="pre">class</span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">model.denoising.microbatches.</span></span><span class="sig-name descname"><span class="pre">RampupBatchsizeNumMicroBatches</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">start_batch_size</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">batch_size_increment</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">ramup_samples</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">global_batch_size</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">micro_batch_size</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">data_parallel_size</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#model.denoising.microbatches.RampupBatchsizeNumMicroBatches" title="Link to this definition"></a></dt>
<dd><p>Bases: <a class="reference internal" href="#model.denoising.microbatches.NumMicroBatchesCalculator" title="model.denoising.microbatches.NumMicroBatchesCalculator"><code class="xref py py-class docutils literal notranslate"><span class="pre">NumMicroBatchesCalculator</span></code></a></p>
<dl class="py method">
<dt class="sig sig-object py" id="model.denoising.microbatches.RampupBatchsizeNumMicroBatches.update">
<span class="sig-name descname"><span class="pre">update</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">consumed_samples</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">consistency_check</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#model.denoising.microbatches.RampupBatchsizeNumMicroBatches.update" title="Link to this definition"></a></dt>
<dd></dd></dl>

</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="model.denoising.microbatches.build_num_microbatches_calculator">
<span class="sig-prename descclassname"><span class="pre">model.denoising.microbatches.</span></span><span class="sig-name descname"><span class="pre">build_num_microbatches_calculator</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">args</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#model.denoising.microbatches.build_num_microbatches_calculator" title="Link to this definition"></a></dt>
<dd></dd></dl>

</section>
<section id="module-model.denoising.p2p_communication">
<span id="model-denoising-p2p-communication-module"></span><h2>model.denoising.p2p_communication module<a class="headerlink" href="#module-model.denoising.p2p_communication" title="Link to this heading"></a></h2>
<dl class="py function">
<dt class="sig sig-object py" id="model.denoising.p2p_communication.recv_backward">
<span class="sig-prename descclassname"><span class="pre">model.denoising.p2p_communication.</span></span><span class="sig-name descname"><span class="pre">recv_backward</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">timers</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#model.denoising.p2p_communication.recv_backward" title="Link to this definition"></a></dt>
<dd><p>Receive tensor from next rank in pipeline (backward receive).</p>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="model.denoising.p2p_communication.recv_forward">
<span class="sig-prename descclassname"><span class="pre">model.denoising.p2p_communication.</span></span><span class="sig-name descname"><span class="pre">recv_forward</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">tensor_shape</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">override_scatter_gather_tensors_in_pipeline</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">dtype_</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">timers</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#model.denoising.p2p_communication.recv_forward" title="Link to this definition"></a></dt>
<dd><p>Receive tensor from previous rank in pipeline (forward receive).</p>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="model.denoising.p2p_communication.send_backward">
<span class="sig-prename descclassname"><span class="pre">model.denoising.p2p_communication.</span></span><span class="sig-name descname"><span class="pre">send_backward</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">input_tensor_grad</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">timers</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#model.denoising.p2p_communication.send_backward" title="Link to this definition"></a></dt>
<dd><p>Send tensor to previous rank in pipeline (backward send).</p>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="model.denoising.p2p_communication.send_backward_recv_backward">
<span class="sig-prename descclassname"><span class="pre">model.denoising.p2p_communication.</span></span><span class="sig-name descname"><span class="pre">send_backward_recv_backward</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">input_tensor_grad</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">recv_next</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">timers</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#model.denoising.p2p_communication.send_backward_recv_backward" title="Link to this definition"></a></dt>
<dd><p>Batched recv from next rank and send to previous rank in pipeline.</p>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="model.denoising.p2p_communication.send_backward_recv_forward">
<span class="sig-prename descclassname"><span class="pre">model.denoising.p2p_communication.</span></span><span class="sig-name descname"><span class="pre">send_backward_recv_forward</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">input_tensor_grad</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">timers</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#model.denoising.p2p_communication.send_backward_recv_forward" title="Link to this definition"></a></dt>
<dd><p>Batched send and recv with previous rank in pipeline.</p>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="model.denoising.p2p_communication.send_forward">
<span class="sig-prename descclassname"><span class="pre">model.denoising.p2p_communication.</span></span><span class="sig-name descname"><span class="pre">send_forward</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">output_tensor</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">timers</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">override_scatter_gather_tensors_in_pipeline</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">dtype_</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#model.denoising.p2p_communication.send_forward" title="Link to this definition"></a></dt>
<dd><p>Send tensor to next rank in pipeline (forward send).</p>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="model.denoising.p2p_communication.send_forward_backward_recv_forward_backward">
<span class="sig-prename descclassname"><span class="pre">model.denoising.p2p_communication.</span></span><span class="sig-name descname"><span class="pre">send_forward_backward_recv_forward_backward</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">output_tensor</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">input_tensor_grad</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">recv_prev</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">recv_next</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">timers</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#model.denoising.p2p_communication.send_forward_backward_recv_forward_backward" title="Link to this definition"></a></dt>
<dd><p>Batched send and recv with previous and next ranks in pipeline.</p>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="model.denoising.p2p_communication.send_forward_recv_backward">
<span class="sig-prename descclassname"><span class="pre">model.denoising.p2p_communication.</span></span><span class="sig-name descname"><span class="pre">send_forward_recv_backward</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">output_tensor</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">timers</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#model.denoising.p2p_communication.send_forward_recv_backward" title="Link to this definition"></a></dt>
<dd><p>Batched send and recv with next rank in pipeline.</p>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="model.denoising.p2p_communication.send_forward_recv_forward">
<span class="sig-prename descclassname"><span class="pre">model.denoising.p2p_communication.</span></span><span class="sig-name descname"><span class="pre">send_forward_recv_forward</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">output_tensor</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">recv_prev</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">timers</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#model.denoising.p2p_communication.send_forward_recv_forward" title="Link to this definition"></a></dt>
<dd><p>Batched recv from previous rank and send to next rank in pipeline.</p>
</dd></dl>

</section>
<section id="module-model.denoising.package_info">
<span id="model-denoising-package-info-module"></span><h2>model.denoising.package_info module<a class="headerlink" href="#module-model.denoising.package_info" title="Link to this heading"></a></h2>
</section>
<section id="module-model.denoising.schedules">
<span id="model-denoising-schedules-module"></span><h2>model.denoising.schedules module<a class="headerlink" href="#module-model.denoising.schedules" title="Link to this heading"></a></h2>
<dl class="py function">
<dt class="sig sig-object py" id="model.denoising.schedules.backward_step">
<span class="sig-prename descclassname"><span class="pre">model.denoising.schedules.</span></span><span class="sig-name descname"><span class="pre">backward_step</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">optimizer</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">input_tensor</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">output_tensor</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">output_tensor_grad</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#model.denoising.schedules.backward_step" title="Link to this definition"></a></dt>
<dd><p>Backward step through passed-in output tensor.</p>
<p>If last stage, output_tensor_grad is None, otherwise gradient of loss
with respect to stage’s output tensor.</p>
<p>Returns gradient of loss with respect to input tensor (None if first
stage).</p>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="model.denoising.schedules.dummy_handler">
<span class="sig-prename descclassname"><span class="pre">model.denoising.schedules.</span></span><span class="sig-name descname"><span class="pre">dummy_handler</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#model.denoising.schedules.dummy_handler" title="Link to this definition"></a></dt>
<dd></dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="model.denoising.schedules.forward_backward_no_pipelining">
<span class="sig-prename descclassname"><span class="pre">model.denoising.schedules.</span></span><span class="sig-name descname"><span class="pre">forward_backward_no_pipelining</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">forward_step_func</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">data_iterator</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">model</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">optimizer</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">timers</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">forward_only</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">test_only</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#model.denoising.schedules.forward_backward_no_pipelining" title="Link to this definition"></a></dt>
<dd><p>Run forward and backward passes with no pipeline parallelism
(no inter-stage communication).</p>
<p>Returns dictionary with losses.</p>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="model.denoising.schedules.forward_backward_pipelining_with_interleaving">
<span class="sig-prename descclassname"><span class="pre">model.denoising.schedules.</span></span><span class="sig-name descname"><span class="pre">forward_backward_pipelining_with_interleaving</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">forward_step_func</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">data_iterator</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">model</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">optimizer</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">timers</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">forward_only</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#model.denoising.schedules.forward_backward_pipelining_with_interleaving" title="Link to this definition"></a></dt>
<dd><p>Run interleaved 1F1B schedule (model split into model chunks), with
communication between pipeline stages as needed.</p>
<p>Returns dictionary with losses if the last stage, empty dict otherwise.</p>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="model.denoising.schedules.forward_backward_pipelining_without_interleaving">
<span class="sig-prename descclassname"><span class="pre">model.denoising.schedules.</span></span><span class="sig-name descname"><span class="pre">forward_backward_pipelining_without_interleaving</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">forward_step_func</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">data_iterator</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">model</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">optimizer</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">timers</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">forward_only</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#model.denoising.schedules.forward_backward_pipelining_without_interleaving" title="Link to this definition"></a></dt>
<dd><p>Run non-interleaved 1F1B schedule, with communication between pipeline
stages.</p>
<p>Returns dictionary with losses if the last stage, empty dict otherwise.</p>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="model.denoising.schedules.forward_step">
<span class="sig-prename descclassname"><span class="pre">model.denoising.schedules.</span></span><span class="sig-name descname"><span class="pre">forward_step</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">forward_step_func</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">data_iterator</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">model</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">input_tensor</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">losses_reduced</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#model.denoising.schedules.forward_step" title="Link to this definition"></a></dt>
<dd><p>Forward step for passed-in model.</p>
<p>If first stage, input tensor is obtained from data_iterator, otherwise
passed-in input_tensor is used.</p>
<p>Returns output tensor.</p>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="model.denoising.schedules.forward_step_wrapper">
<span class="sig-prename descclassname"><span class="pre">model.denoising.schedules.</span></span><span class="sig-name descname"><span class="pre">forward_step_wrapper</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">forward_step_func</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">data_iterator</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">model</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">input_tensor</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">losses_reduced</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">test_only</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#model.denoising.schedules.forward_step_wrapper" title="Link to this definition"></a></dt>
<dd><p>Forward step for passed-in model.</p>
<p>If first stage, input tensor is obtained from data_iterator, otherwise
passed-in input_tensor is used.</p>
<p>Returns output tensor.</p>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="model.denoising.schedules.get_forward_backward_func">
<span class="sig-prename descclassname"><span class="pre">model.denoising.schedules.</span></span><span class="sig-name descname"><span class="pre">get_forward_backward_func</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#model.denoising.schedules.get_forward_backward_func" title="Link to this definition"></a></dt>
<dd></dd></dl>

</section>
<section id="module-model.denoising.training">
<span id="model-denoising-training-module"></span><h2>model.denoising.training module<a class="headerlink" href="#module-model.denoising.training" title="Link to this heading"></a></h2>
<p>Pretrain utilities.</p>
<dl class="py function">
<dt class="sig sig-object py" id="model.denoising.training.build_train_valid_test_data_iterators">
<span class="sig-prename descclassname"><span class="pre">model.denoising.training.</span></span><span class="sig-name descname"><span class="pre">build_train_valid_test_data_iterators</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">build_train_valid_test_datasets_provider</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#model.denoising.training.build_train_valid_test_data_iterators" title="Link to this definition"></a></dt>
<dd><p>XXX</p>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="model.denoising.training.cyclic_iter">
<span class="sig-prename descclassname"><span class="pre">model.denoising.training.</span></span><span class="sig-name descname"><span class="pre">cyclic_iter</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">iter</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#model.denoising.training.cyclic_iter" title="Link to this definition"></a></dt>
<dd></dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="model.denoising.training.evaluate">
<span class="sig-prename descclassname"><span class="pre">model.denoising.training.</span></span><span class="sig-name descname"><span class="pre">evaluate</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">forward_step_func</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">data_iterator</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">model</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">verbose</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#model.denoising.training.evaluate" title="Link to this definition"></a></dt>
<dd><p>Evaluation.</p>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="model.denoising.training.evaluate_and_print_results">
<span class="sig-prename descclassname"><span class="pre">model.denoising.training.</span></span><span class="sig-name descname"><span class="pre">evaluate_and_print_results</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">prefix</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">forward_step_func</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">data_iterator</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">model</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">iteration</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">verbose</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#model.denoising.training.evaluate_and_print_results" title="Link to this definition"></a></dt>
<dd><p>Helper function to evaluate and dump results on screen.</p>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="model.denoising.training.get_learning_rate_scheduler">
<span class="sig-prename descclassname"><span class="pre">model.denoising.training.</span></span><span class="sig-name descname"><span class="pre">get_learning_rate_scheduler</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">optimizer</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#model.denoising.training.get_learning_rate_scheduler" title="Link to this definition"></a></dt>
<dd><p>Build the learning rate scheduler.</p>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="model.denoising.training.get_model">
<span class="sig-prename descclassname"><span class="pre">model.denoising.training.</span></span><span class="sig-name descname"><span class="pre">get_model</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">model_provider_func</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#model.denoising.training.get_model" title="Link to this definition"></a></dt>
<dd><p>Build the model.</p>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="model.denoising.training.pretrain">
<span class="sig-prename descclassname"><span class="pre">model.denoising.training.</span></span><span class="sig-name descname"><span class="pre">pretrain</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">train_valid_test_dataset_provider</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">model_provider</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">forward_step_func</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">extra_args_provider</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">args_defaults</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">{}</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#model.denoising.training.pretrain" title="Link to this definition"></a></dt>
<dd><p>Main training program.</p>
<dl class="simple">
<dt>This function will run the followings in the order provided:</dt><dd><ol class="arabic simple">
<li><p>initialize Megatron.</p></li>
<li><p>setup model, optimizer and lr schedule using the model_provider.</p></li>
<li><p>call train_val_test_data_provider to get train/val/test datasets.</p></li>
<li><p>train the modle using the forward_step_func.</p></li>
</ol>
</dd>
</dl>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>train_valid_test_dataset_provider</strong> – a function that takes the size of
train/valid/test dataset and returns <cite>train, valid, test</cite> datasets.</p></li>
<li><p><strong>model_provider</strong> – a function that returns a vanilla version of the
model. By vanilla we mean a simple model on cpu with no fp16 or ddp.</p></li>
<li><p><strong>forward_step_func</strong> – a function that takes a <cite>data iterator</cite> and <cite>model</cite>,
and returns a <cite>loss</cite> scalar with a dictionary with key:values being
the info we would like to monitor during training, for example
<cite>lm-loss: value</cite>. We also require that this function add
<cite>batch generator</cite> to the timers class.</p></li>
<li><p><strong>extra_args_provider</strong> – a function that takes a parser and adds arguments
to it. It is used for programs to add their own arguments.</p></li>
<li><p><strong>args_defaults</strong> – a dictionary from argument-name to argument-value. It
to set already parse arguments.</p></li>
</ul>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="model.denoising.training.print_datetime">
<span class="sig-prename descclassname"><span class="pre">model.denoising.training.</span></span><span class="sig-name descname"><span class="pre">print_datetime</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">string</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#model.denoising.training.print_datetime" title="Link to this definition"></a></dt>
<dd><p>Note that this call will sync across all ranks.</p>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="model.denoising.training.save_checkpoint_and_time">
<span class="sig-prename descclassname"><span class="pre">model.denoising.training.</span></span><span class="sig-name descname"><span class="pre">save_checkpoint_and_time</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">iteration</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">model</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">optimizer</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">lr_scheduler</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#model.denoising.training.save_checkpoint_and_time" title="Link to this definition"></a></dt>
<dd></dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="model.denoising.training.setup_model_and_optimizer">
<span class="sig-prename descclassname"><span class="pre">model.denoising.training.</span></span><span class="sig-name descname"><span class="pre">setup_model_and_optimizer</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">model_provider_func</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#model.denoising.training.setup_model_and_optimizer" title="Link to this definition"></a></dt>
<dd><p>Setup model and optimizer.</p>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="model.denoising.training.train">
<span class="sig-prename descclassname"><span class="pre">model.denoising.training.</span></span><span class="sig-name descname"><span class="pre">train</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">forward_step_func</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">model</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">optimizer</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">lr_scheduler</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">train_data_iterator</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">valid_data_iterator</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">test_data_iterator</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#model.denoising.training.train" title="Link to this definition"></a></dt>
<dd><p>Train the model function.</p>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="model.denoising.training.train_step">
<span class="sig-prename descclassname"><span class="pre">model.denoising.training.</span></span><span class="sig-name descname"><span class="pre">train_step</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">forward_step_func</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">data_iterator</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">model</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">optimizer</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">lr_scheduler</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#model.denoising.training.train_step" title="Link to this definition"></a></dt>
<dd><p>Single training step.</p>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="model.denoising.training.training_log">
<span class="sig-prename descclassname"><span class="pre">model.denoising.training.</span></span><span class="sig-name descname"><span class="pre">training_log</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">loss_dict</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">total_loss_dict</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">learning_rate</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">iteration</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">loss_scale</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">report_memory_flag</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">skipped_iter</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">grad_norm</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">params_norm</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">num_zeros_in_grad</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#model.denoising.training.training_log" title="Link to this definition"></a></dt>
<dd><p>Log training information such as losses, timing, ….</p>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="model.denoising.training.update_train_iters">
<span class="sig-prename descclassname"><span class="pre">model.denoising.training.</span></span><span class="sig-name descname"><span class="pre">update_train_iters</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">args</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#model.denoising.training.update_train_iters" title="Link to this definition"></a></dt>
<dd></dd></dl>

</section>
<section id="module-model.denoising.utils">
<span id="model-denoising-utils-module"></span><h2>model.denoising.utils module<a class="headerlink" href="#module-model.denoising.utils" title="Link to this heading"></a></h2>
<p>General utilities.</p>
<dl class="py function">
<dt class="sig sig-object py" id="model.denoising.utils.average_losses_across_data_parallel_group">
<span class="sig-prename descclassname"><span class="pre">model.denoising.utils.</span></span><span class="sig-name descname"><span class="pre">average_losses_across_data_parallel_group</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">losses</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#model.denoising.utils.average_losses_across_data_parallel_group" title="Link to this definition"></a></dt>
<dd><p>Reduce a tensor of losses across all GPUs.</p>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="model.denoising.utils.calc_params_l2_norm">
<span class="sig-prename descclassname"><span class="pre">model.denoising.utils.</span></span><span class="sig-name descname"><span class="pre">calc_params_l2_norm</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">model</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#model.denoising.utils.calc_params_l2_norm" title="Link to this definition"></a></dt>
<dd><p>Calculate l2 norm of parameters</p>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="model.denoising.utils.check_adlr_autoresume_termination">
<span class="sig-prename descclassname"><span class="pre">model.denoising.utils.</span></span><span class="sig-name descname"><span class="pre">check_adlr_autoresume_termination</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">iteration</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">model</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">optimizer</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">lr_scheduler</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#model.denoising.utils.check_adlr_autoresume_termination" title="Link to this definition"></a></dt>
<dd><p>Check for autoresume signal and exit if it is received.</p>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="model.denoising.utils.get_ltor_masks_and_position_ids">
<span class="sig-prename descclassname"><span class="pre">model.denoising.utils.</span></span><span class="sig-name descname"><span class="pre">get_ltor_masks_and_position_ids</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">data</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">eod_token</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">reset_position_ids</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">reset_attention_mask</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">eod_mask_loss</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#model.denoising.utils.get_ltor_masks_and_position_ids" title="Link to this definition"></a></dt>
<dd><p>Build masks and position id for left to right model.</p>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="model.denoising.utils.print_params_min_max_norm">
<span class="sig-prename descclassname"><span class="pre">model.denoising.utils.</span></span><span class="sig-name descname"><span class="pre">print_params_min_max_norm</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">optimizer</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">iteration</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#model.denoising.utils.print_params_min_max_norm" title="Link to this definition"></a></dt>
<dd><p>Print min, max, and norm of all parameters.</p>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="model.denoising.utils.report_memory">
<span class="sig-prename descclassname"><span class="pre">model.denoising.utils.</span></span><span class="sig-name descname"><span class="pre">report_memory</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">name</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#model.denoising.utils.report_memory" title="Link to this definition"></a></dt>
<dd><p>Simple GPU memory report.</p>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="model.denoising.utils.unwrap_model">
<span class="sig-prename descclassname"><span class="pre">model.denoising.utils.</span></span><span class="sig-name descname"><span class="pre">unwrap_model</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">model</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">module_instances</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">torch.nn.parallel.DistributedDataParallel</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#model.denoising.utils.unwrap_model" title="Link to this definition"></a></dt>
<dd></dd></dl>

</section>
<section id="module-model.denoising">
<span id="module-contents"></span><h2>Module contents<a class="headerlink" href="#module-model.denoising" title="Link to this heading"></a></h2>
<dl class="py function">
<dt class="sig sig-object py" id="model.denoising.is_last_rank">
<span class="sig-prename descclassname"><span class="pre">model.denoising.</span></span><span class="sig-name descname"><span class="pre">is_last_rank</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#model.denoising.is_last_rank" title="Link to this definition"></a></dt>
<dd></dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="model.denoising.print_rank_0">
<span class="sig-prename descclassname"><span class="pre">model.denoising.</span></span><span class="sig-name descname"><span class="pre">print_rank_0</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">message</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#model.denoising.print_rank_0" title="Link to this definition"></a></dt>
<dd><p>If distributed is initialized, print only on rank 0.</p>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="model.denoising.print_rank_last">
<span class="sig-prename descclassname"><span class="pre">model.denoising.</span></span><span class="sig-name descname"><span class="pre">print_rank_last</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">message</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#model.denoising.print_rank_last" title="Link to this definition"></a></dt>
<dd><p>If distributed is initialized, print only on last rank.</p>
</dd></dl>

</section>
</section>


           </div>
          </div>
          <footer><div class="rst-footer-buttons" role="navigation" aria-label="Footer">
        <a href="model.classify.html" class="btn btn-neutral float-left" title="model.classify package" accesskey="p" rel="prev"><span class="fa fa-arrow-circle-left" aria-hidden="true"></span> Previous</a>
        <a href="model.denoising.data.html" class="btn btn-neutral float-right" title="model.denoising.data package" accesskey="n" rel="next">Next <span class="fa fa-arrow-circle-right" aria-hidden="true"></span></a>
    </div>

  <hr/>

  <div role="contentinfo">
    <p>&#169; Copyright 2024, Yue Zhou, Tianyu Zhao.</p>
  </div>

  Built with <a href="https://www.sphinx-doc.org/">Sphinx</a> using a
    <a href="https://github.com/readthedocs/sphinx_rtd_theme">theme</a>
    provided by <a href="https://readthedocs.org">Read the Docs</a>.
   

</footer>
        </div>
      </div>
    </section>
  </div>
  <script>
      jQuery(function () {
          SphinxRtdTheme.Navigation.enable(true);
      });
  </script> 

</body>
</html>